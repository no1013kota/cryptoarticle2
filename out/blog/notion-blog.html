<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/4bc12c1be68739c7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4bc12c1be68739c7.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8d58b9228ffac9a6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8d58b9228ffac9a6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-d7b038a63b619762.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-101cfeaa18eb0e64.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5a602b05d6a5b45c.js" defer=""></script><script src="/_next/static/chunks/451-8446afed8f2a81ca.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bid%5D-7b5e07e6b1c54b77.js" defer=""></script><script src="/_next/static/EwuWiZmkeG3lYlO_XC9fM/_buildManifest.js" defer=""></script><script src="/_next/static/EwuWiZmkeG3lYlO_XC9fM/_ssgManifest.js" defer=""></script><script src="/_next/static/EwuWiZmkeG3lYlO_XC9fM/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><style data-emotion="css a6by8m">.css-a6by8m{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:auto;}</style><div class="MuiGrid-root MuiGrid-container css-a6by8m"><style data-emotion="css d0aeej">.css-d0aeej{background-color:#FFF;color:#222;margin:30px auto;padding:36px;}.css-d0aeej h1,.css-d0aeej h2,.css-d0aeej h3{font-weight:550;}</style><style data-emotion="css vx8k43">.css-vx8k43{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:91.666667%;-ms-flex-preferred-size:91.666667%;flex-basis:91.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:91.666667%;background-color:#FFF;color:#222;margin:30px auto;padding:36px;}@media (min-width:600px){.css-vx8k43{-webkit-flex-basis:91.666667%;-ms-flex-preferred-size:91.666667%;flex-basis:91.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:91.666667%;}}@media (min-width:900px){.css-vx8k43{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}@media (min-width:1200px){.css-vx8k43{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}@media (min-width:1536px){.css-vx8k43{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}.css-vx8k43 h1,.css-vx8k43 h2,.css-vx8k43 h3{font-weight:550;}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-11 MuiGrid-grid-md-9 css-vx8k43"><style data-emotion="css tph460">.css-tph460{padding:15px 0px;border-bottom:1px solid #4682B4;}</style><div class="css-tph460"><style data-emotion="css 1x4m838">.css-1x4m838{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;font-size:26px;font-weight:540;padding-bottom:16px;}</style><p class="MuiTypography-root MuiTypography-body1 css-1x4m838">Notion BlogをヘッドレスCMSとして、Next.jsで個人ブログを作ってみた</p><style data-emotion="css q5vujz">.css-q5vujz{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;display:inline-block;padding-right:32px;}</style><p class="MuiTypography-root MuiTypography-body2 css-q5vujz"><style data-emotion="css 1eipbkb">.css-1eipbkb{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;font-size:15px;margin-right:4px;vertical-align:middle;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1eipbkb" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="AccessTimeIcon"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path><path d="M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"></path></svg>投稿日 <!-- -->2022/1/9</p><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1eipbkb" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LocalOfferIcon"><path d="m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"></path></svg><style data-emotion="css 1lc4u9f">.css-1lc4u9f{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;display:inline-block;padding-right:8px;}</style><p class="MuiTypography-root MuiTypography-body2 css-1lc4u9f">#<!-- -->Next.js</p><p class="MuiTypography-root MuiTypography-body2 css-1lc4u9f">#<!-- -->React</p></div><style data-emotion="css il3arz">.css-il3arz{margin-top:40px;}.css-il3arz a{color:#639bb7;}.css-il3arz a:hover{color:#0b7eb8;-webkit-text-decoration:underline;text-decoration:underline;}</style><div class="css-il3arz"><html><head></head><body><h2 id="h8d027c8ed3">はじめに</h2><p>年末年始1週間の自由研究として、Next.jsを使って何か作ってみたい…ということで、NotionをヘッドレスCMSとした個人ブログを作ってみました。<br><br>せっかくなので制作日記として、</p><ul><li> 作ったものを紹介</li><li> Notion Blogについて</li><li> Next.js（React）を使って自分で実装した機能</li></ul><p>などまとめておきたいと思います。<br><br>※ヘッドレスCMSとは…従来型のCMS（WordPress等）は入稿画面・DB・表示画面をまとめて管理するのに対し、ここから表示画面を除いたもの。ヘッドレスCMSでは、API経由で取得したコンテンツを基にフロントエンド部分は自前で実装する必要がある。<br></p><h2 id="he961b4efa4">制作物について</h2><p>実際に作ったものがこちらです。<br><a href="https://hinako-blog.vercel.app/blog" target="_blank" rel="noopener noreferrer">Hinako Blog | My Profile</a><br></p><h3 id="h0d376e5d4e">構成</h3><p>構成を簡単に説明すると、<br></p><ul><li>Notion上にブログ記事を保管するDBを作り、Notionで記事を執筆</li><li>Next.jsのgetStaticPropsでNotionのAPIを叩いてブログコンテンツを取得</li><li>Next.jsでレスポンスを成形してビューに表示</li></ul><p><br>という感じです。<br><br>NotionのAPIを叩いてレスポンスを成形する部分は、Notion Blog（詳しくは後述）というOSSのテンプレートをベースに使わせていただきました。<br>デプロイはVercelで行いました。<br></p><h3 id="had81f6e58c">実装した機能</h3><ul><li>MITライセンスのOSSとして公開されているNotion Blog（Vercel社のJJ Kasperさん作）をベースに使用</li><li>DBにcategoryのカラムを追加し、NotionのAPIからのレスポンスの成形やビューへの表示をカスタマイズ</li><li>フロント側での「カテゴリーの選択」「投稿した月の選択」「フリーキーワードによる検索」によるリアルタイム検索機能</li><li>記事のカテゴリーに応じてReact iconsでアイコンを表示する</li><li>CSS Modules</li><li>UIパーツのコンポーネント化</li><li>propsやstateの値により、条件付きレンダリングを行ったりCSSを動的に切り替える</li></ul><p><br></p><h2 id="h5043d0744e">Notion Blogについて</h2><p>ベースに使用したNotion Blogというのは、NotionのAPIを叩いてNotionからコンテンツを取得しNext.jsでビューを作ったテンプレートです。<br><br>GitHub：<a style="color:#4aac00" href="https://github.com/ijjk/notion-blog" target="_blank" rel="noopener noreferrer">https://github.com/ijjk/notion-blog</a><br>公式のサンプルページ：<a style="color:#4aac00" href="https://notion-blog.vercel.app/" target="_blank" rel="noopener noreferrer">https://notion-blog.vercel.app/</a><br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/007ccf5040c24c7dad664d036d40997e/notion-blog.png" alt=""><br>こんな感じでシンプルで綺麗なUIをしています。<br>コードをいじったりしなくても、DeployボタンからVercelに連携し、NotionのDBのID・Tokenを環境変数に設定してVercelでデプロイするだけで、このテンプレート通りの個人ブログが出来るというものです。<br></p><h3 id="h0893011e20">Notion Blogでブログコンテンツを取得する仕組み</h3><p>あらかじめNotionで記事を登録するDB（Page, Slug, Published, Date, Authorsの5つの要素を持つインラインテーブル）を作り、このテーブルに記事を入れておきます。<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2df6468fd6054e47b8f1f212f7e5fa3a/table.png" alt=""><br>画像引用：<a style="color:#4aac00" href="https://github.com/ijjk/notion-blog#manually-creating-the-table" target="_blank" rel="noopener noreferrer">https://github.com/ijjk/notion-blog#manually-creating-the-table</a><br><br>Notion Blogのソースを見ると、Next.jsのgetStaticPropsでNotionのAPIを叩いてデータベースのコンテンツを取得しています。<br>使っているのは非公式のAPIで「<a style="color:#4aac00" href="https://www.notion.so/api/v3%E3%80%8D" target="_blank" rel="noopener noreferrer">https://www.notion.so/api/v3」</a>&nbsp;というエンドポイントを叩いているようです。<br></p><h3 id="h814caf386c">Notion Blogを使った理由</h3><p>Notion 公式のAPI（ベータ版）も2021年5月に公開され、OSSとして公開されているテンプレートで公式APIが使われているものもある中で、Notion Blogを選んだ理由は以下の通りです。<br></p><ul><li>公式のNotion APIはコードブロックに対応していない（もしアップデートを見落としていたらすみません。）</li><li>公式のNotion APIでは、コンテンツを取得するだけでなくAPIを使ってNotionのDBへ追加・更新・削除する機能もあるが、これらの機能は不要と思った。</li><li>Notion Blogでは、決められた5つのカラムを持つテーブルをNotionで作るだけでテンプレート通りに表示される。簡単！はやい！</li></ul><p><br>ざっくりいうと、<strong>とりあえず最速・簡単な方法で小さく作って、残った時間でカスタマイズしてみよう</strong>という感じです。<br></p><h3 id="h2c8c89326b">Notion Blogのセットアップ方法</h3><p>セットアップ方法は、公式サンプルのページに動画付きで分かりやすく書かれているので省略します。<br><br><a style="color:#4aac00" href="https://notion-blog.vercel.app/blog/my-first-post" target="_blank" rel="noopener noreferrer">https://notion-blog.vercel.app/blog/my-first-post</a><br>Deployボタンからコードを目にすることも無くデプロイすることも出来るようですが、今回はAPIから受け取るレスポンスの成形やUIはカスタマイズする前提だったので、git cloneして編集したうえでデプロイしました。<br></p><h3 id="h1d7f1fe064">Notion Blogを使ってみて</h3><ul><li>テンプレートのコードを読んで</li></ul><p>APIへのリクエストを行うメソッドのファイル切り分け・ディレクトリ構成が分かりやすく、カスタマイズしやすかったです。<br>Next.jsのダイナミックルーティングを使う際に、ヘッダのメタ情報を出しわける書き方も初めて見て勉強になりました。<br><br>ここからは、ブログ記事をブラウザで表示した時の見え方についてです。<br></p><ul><li>画像・動画の挿入</li></ul><p>簡単に挿入できるものの、画像のアスペクト比が若干おかしくなっていました…。<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/be464a17a7d74abe9afdcd84d268199b/%E7%94%BB%E5%83%8F%E5%8B%95%E7%94%BB.png" alt=""><br><br><br>動画はNotionで見たまま反映され、再生速度の調整まで出来るのでこれはスゴイ！感激でした。<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/f1847b01ffc84d62a89559fd86c389ce/%E5%8B%95%E7%94%BB.png" alt=""><br></p><ul><li>コードブロックの挿入</li></ul><p>公式APIでは対応していないコードブロックも、非公式APIを使っているNotion Blogでは表示できました。<br>文字色のCSSなんかも自由にカスタマイズできます。<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/20ed291c84c841a8a67807a6c96c2514/%E3%82%B3%E3%83%BC%E3%83%89%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF.png" alt=""><br><br>ただしNotion Blogで使っているのは非公式APIなので、<br></p><ul><li>動作が不安定（実際、稀にコンテンツが取得できないという事が起こりました。）</li><li>今後このAPIが使えなくなる可能性もある</li><li><br></li></ul><p>というデメリットはあると思われます。<br></p><h2 id="hafa005fc12">自分で実装した機能</h2><p>自分で追加実装した機能や、その他使用技術について書いていきます。<br></p><h3 id="h604b8042b8">検索機能</h3><p>カテゴリーで絞り込み・投稿月で絞りこみ・フリーキーワード検索の機能を実装しました。<br><br>ページ上部<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/5d8f8a862a3344fc8fe16447103ba0f6/%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8A%E9%83%A8.png" alt=""><br><br>フッター<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2cd3e007541943cb82954cf062c40479/%E3%83%95%E3%83%83%E3%82%BF%E3%83%BC.png" alt=""><br><br>【実装手順】<br>①　APIから取得したブログコンテンツに存在するカテゴリーを配列に格納して、記事が存在する分のカテゴリーボタンを表示。投稿月についても同様。<br>②　ボタンを押したときや検索欄に入力をした際に発火する絞り込み処理を実装。<br><br>フロント側で保持している記事データに対して絞り込みを行い表示を切り替える機能なので、リロードなく瞬時に表示が切り替わります。<br>検索機能の書き方は非常に勉強になったので、別記事にまとめようと思います。<br></p><h3 id="hc06cf54a32">React Icons</h3><p>記事のカテゴリーに応じてアイコンを表示しました。<br><img src="https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/6d8cb6b91d2740649bcd296b5d054bf6/react-icon.png" alt=""><br><br><br>アイコンといえばFontAwesomeと思っていましたが、React用のライブラリがありました。<br><a href="https://react-icons.github.io/react-icons/" target="_blank" rel="noopener noreferrer">React Icons</a><br><br>このライブラリをインストールすると、Font Awesome や Material、Typicons、Codicons（VSCode のアイコン）など色んな種類のアイコンを簡単に利用することができます。<br>使い方は以下の記事を参考にさせて頂きました。<br><br><a href="https://zenn.dev/taichifukumoto/articles/how-to-use-react-icons" target="_blank" rel="noopener noreferrer">React でアイコンを使うなら React Icons がおすすめ</a><br></p><h3 id="h5a4cb7eb5d">CSS Modules</h3><p>CSSは、Notion BlogでCSS Modulesが使われていたので、そのままCSS Modulesを使いました。<br><strong><code>.module.css</code></strong>&nbsp;で定義したクラス名がそのまま付与されるのではなく、実際はユニークなクラス名が自動的に生成されて付与されることも検証ツールで確認できて、勉強になりました。<br><br>Reactのプロジェクト下でのCSSといえば代表的な選択肢は、CSS Modules、styled-component、Tailwindあたりなのかと思いますが、それぞれの違いやメリットデメリットについては正直勉強不足です。。<br><a href="https://kenzoblog.vercel.app/posts/css-manage" target="_blank" rel="noopener noreferrer">styled-components, CSS Modules について調べたのでまとめる</a><br><br>業務ではTailwindを使っており、今回初めてCSS Modulesを使い、両者の個人的な感想を書いておきます。<br></p><ul><li>Tailwind</li></ul><p>ファイルの行き来をせずスタイルを確認できて便利。小規模なプロダクトに向いていそう。<br></p><ul><li>CSS Modules</li></ul><p>コンポーネント単位でスタイルをまとめるという思想なので、コンポーネント指向のReactとの相性は良い（のだと思う）。<br>スタイルの共通化がしやすくスッキリ整理整頓されている感じで、使いやすかった。<br></p><h2 id="hf32963c38a">全体の感想</h2><p>長くなってきたので細かい実装については書きませんが、「実装したい機能がある→どうやったら実現できるか調べる」というプロセスでReact・JavaScriptの書き方も色々勉強になりました。<br><br>今回NotionをヘッドレスCMSとして使ってみて、フロントエンドを自前で作るという事は見た目を自由に作れるだけでなく、SG・SSRを使って機能性の高いサイトを作ることが出来ることが大きなメリットだと感じました。<br>先輩に良いアドバイスもいただいたので、今度はまた他のヘッドレスCMSのサービスを使って個人ブログを作ってみたいなと思います。<br></p><h2 id="he45680f0bc">参考記事</h2><p><br><a href="unsafe:[object Object]" target="_blank" rel="noopener noreferrer">Home | My Notion Blog</a><br><br><a href="https://zenn.dev/st43/articles/7982e6d371f8b8#notion-api%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E4%B8%80%E8%A6%A7" target="_blank" rel="noopener noreferrer">現在のNotion API（2021/7/13）で何がどこまでできるか</a><br><br><a href="https://zenn.dev/st43/articles/9a714916c50b80#%E3%81%BE%E3%81%A8%E3%82%81" target="_blank" rel="noopener noreferrer">notion-blogで無料の個人ブログをつくってみました</a><br></p></body></html></div></div></div><style data-emotion="css 2sbw87">.css-2sbw87{background-color:#494949;margin:0 auto;padding-top:30px;padding-bottom:30px;color:#f2f2f2;letter-spacing:0.08rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-around;-ms-flex-pack:space-around;-webkit-justify-content:space-around;justify-content:space-around;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}</style><div class="css-2sbw87"><style data-emotion="css kta5xp">.css-kta5xp{box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:83.333333%;-ms-flex-preferred-size:83.333333%;flex-basis:83.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:83.333333%;}@media (min-width:600px){.css-kta5xp{-webkit-flex-basis:83.333333%;-ms-flex-preferred-size:83.333333%;flex-basis:83.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:83.333333%;}}@media (min-width:900px){.css-kta5xp{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1200px){.css-kta5xp{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1536px){.css-kta5xp{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}</style><div class="MuiGrid-root MuiGrid-grid-xs-10 MuiGrid-grid-md-8 css-kta5xp"><style data-emotion="css 1lx0lai">.css-1lx0lai{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;text-align:center;}</style><div class="MuiGrid-root MuiGrid-item css-1lx0lai"><a href="https://twitter.com/napi_nami"><style data-emotion="css 1ea777n">.css-1ea777n{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;margin:8px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1ea777n" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="TwitterIcon"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"></path></svg></a><a href="https://github.com/hinakonagao"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1ea777n" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></a></div><style data-emotion="css 198jr53">.css-198jr53{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;text-align:center;font-weight:200;}</style><p class="MuiTypography-root MuiTypography-body2 css-198jr53">© 2022 hinako blog</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blog":{"id":"notion-blog","createdAt":"2022-02-12T11:09:01.126Z","updatedAt":"2022-02-12T11:09:56.858Z","publishedAt":"2022-01-09T11:09:01.000Z","revisedAt":"2022-02-12T11:09:56.858Z","title":"Notion BlogをヘッドレスCMSとして、Next.jsで個人ブログを作ってみた","body":"\u003ch2 id=\"h8d027c8ed3\"\u003eはじめに\u003c/h2\u003e\u003cp\u003e年末年始1週間の自由研究として、Next.jsを使って何か作ってみたい…ということで、NotionをヘッドレスCMSとした個人ブログを作ってみました。\u003cbr\u003e\u003cbr\u003eせっかくなので制作日記として、\u003c/p\u003e\u003cul\u003e\u003cli\u003e 作ったものを紹介\u003c/li\u003e\u003cli\u003e Notion Blogについて\u003c/li\u003e\u003cli\u003e Next.js（React）を使って自分で実装した機能\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eなどまとめておきたいと思います。\u003cbr\u003e\u003cbr\u003e※ヘッドレスCMSとは…従来型のCMS（WordPress等）は入稿画面・DB・表示画面をまとめて管理するのに対し、ここから表示画面を除いたもの。ヘッドレスCMSでは、API経由で取得したコンテンツを基にフロントエンド部分は自前で実装する必要がある。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"he961b4efa4\"\u003e制作物について\u003c/h2\u003e\u003cp\u003e実際に作ったものがこちらです。\u003cbr\u003e\u003ca href=\"https://hinako-blog.vercel.app/blog\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eHinako Blog | My Profile\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h0d376e5d4e\"\u003e構成\u003c/h3\u003e\u003cp\u003e構成を簡単に説明すると、\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eNotion上にブログ記事を保管するDBを作り、Notionで記事を執筆\u003c/li\u003e\u003cli\u003eNext.jsのgetStaticPropsでNotionのAPIを叩いてブログコンテンツを取得\u003c/li\u003e\u003cli\u003eNext.jsでレスポンスを成形してビューに表示\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003eという感じです。\u003cbr\u003e\u003cbr\u003eNotionのAPIを叩いてレスポンスを成形する部分は、Notion Blog（詳しくは後述）というOSSのテンプレートをベースに使わせていただきました。\u003cbr\u003eデプロイはVercelで行いました。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"had81f6e58c\"\u003e実装した機能\u003c/h3\u003e\u003cul\u003e\u003cli\u003eMITライセンスのOSSとして公開されているNotion Blog（Vercel社のJJ Kasperさん作）をベースに使用\u003c/li\u003e\u003cli\u003eDBにcategoryのカラムを追加し、NotionのAPIからのレスポンスの成形やビューへの表示をカスタマイズ\u003c/li\u003e\u003cli\u003eフロント側での「カテゴリーの選択」「投稿した月の選択」「フリーキーワードによる検索」によるリアルタイム検索機能\u003c/li\u003e\u003cli\u003e記事のカテゴリーに応じてReact iconsでアイコンを表示する\u003c/li\u003e\u003cli\u003eCSS Modules\u003c/li\u003e\u003cli\u003eUIパーツのコンポーネント化\u003c/li\u003e\u003cli\u003epropsやstateの値により、条件付きレンダリングを行ったりCSSを動的に切り替える\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"h5043d0744e\"\u003eNotion Blogについて\u003c/h2\u003e\u003cp\u003eベースに使用したNotion Blogというのは、NotionのAPIを叩いてNotionからコンテンツを取得しNext.jsでビューを作ったテンプレートです。\u003cbr\u003e\u003cbr\u003eGitHub：\u003ca style=\"color:#4aac00\" href=\"https://github.com/ijjk/notion-blog\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://github.com/ijjk/notion-blog\u003c/a\u003e\u003cbr\u003e公式のサンプルページ：\u003ca style=\"color:#4aac00\" href=\"https://notion-blog.vercel.app/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://notion-blog.vercel.app/\u003c/a\u003e\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/007ccf5040c24c7dad664d036d40997e/notion-blog.png\" alt=\"\"\u003e\u003cbr\u003eこんな感じでシンプルで綺麗なUIをしています。\u003cbr\u003eコードをいじったりしなくても、DeployボタンからVercelに連携し、NotionのDBのID・Tokenを環境変数に設定してVercelでデプロイするだけで、このテンプレート通りの個人ブログが出来るというものです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h0893011e20\"\u003eNotion Blogでブログコンテンツを取得する仕組み\u003c/h3\u003e\u003cp\u003eあらかじめNotionで記事を登録するDB（Page, Slug, Published, Date, Authorsの5つの要素を持つインラインテーブル）を作り、このテーブルに記事を入れておきます。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2df6468fd6054e47b8f1f212f7e5fa3a/table.png\" alt=\"\"\u003e\u003cbr\u003e画像引用：\u003ca style=\"color:#4aac00\" href=\"https://github.com/ijjk/notion-blog#manually-creating-the-table\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://github.com/ijjk/notion-blog#manually-creating-the-table\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eNotion Blogのソースを見ると、Next.jsのgetStaticPropsでNotionのAPIを叩いてデータベースのコンテンツを取得しています。\u003cbr\u003e使っているのは非公式のAPIで「\u003ca style=\"color:#4aac00\" href=\"https://www.notion.so/api/v3%E3%80%8D\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://www.notion.so/api/v3」\u003c/a\u003e\u0026nbsp;というエンドポイントを叩いているようです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h814caf386c\"\u003eNotion Blogを使った理由\u003c/h3\u003e\u003cp\u003eNotion 公式のAPI（ベータ版）も2021年5月に公開され、OSSとして公開されているテンプレートで公式APIが使われているものもある中で、Notion Blogを選んだ理由は以下の通りです。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e公式のNotion APIはコードブロックに対応していない（もしアップデートを見落としていたらすみません。）\u003c/li\u003e\u003cli\u003e公式のNotion APIでは、コンテンツを取得するだけでなくAPIを使ってNotionのDBへ追加・更新・削除する機能もあるが、これらの機能は不要と思った。\u003c/li\u003e\u003cli\u003eNotion Blogでは、決められた5つのカラムを持つテーブルをNotionで作るだけでテンプレート通りに表示される。簡単！はやい！\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003eざっくりいうと、\u003cstrong\u003eとりあえず最速・簡単な方法で小さく作って、残った時間でカスタマイズしてみよう\u003c/strong\u003eという感じです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h2c8c89326b\"\u003eNotion Blogのセットアップ方法\u003c/h3\u003e\u003cp\u003eセットアップ方法は、公式サンプルのページに動画付きで分かりやすく書かれているので省略します。\u003cbr\u003e\u003cbr\u003e\u003ca style=\"color:#4aac00\" href=\"https://notion-blog.vercel.app/blog/my-first-post\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://notion-blog.vercel.app/blog/my-first-post\u003c/a\u003e\u003cbr\u003eDeployボタンからコードを目にすることも無くデプロイすることも出来るようですが、今回はAPIから受け取るレスポンスの成形やUIはカスタマイズする前提だったので、git cloneして編集したうえでデプロイしました。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h1d7f1fe064\"\u003eNotion Blogを使ってみて\u003c/h3\u003e\u003cul\u003e\u003cli\u003eテンプレートのコードを読んで\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eAPIへのリクエストを行うメソッドのファイル切り分け・ディレクトリ構成が分かりやすく、カスタマイズしやすかったです。\u003cbr\u003eNext.jsのダイナミックルーティングを使う際に、ヘッダのメタ情報を出しわける書き方も初めて見て勉強になりました。\u003cbr\u003e\u003cbr\u003eここからは、ブログ記事をブラウザで表示した時の見え方についてです。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e画像・動画の挿入\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e簡単に挿入できるものの、画像のアスペクト比が若干おかしくなっていました…。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/be464a17a7d74abe9afdcd84d268199b/%E7%94%BB%E5%83%8F%E5%8B%95%E7%94%BB.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e動画はNotionで見たまま反映され、再生速度の調整まで出来るのでこれはスゴイ！感激でした。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/f1847b01ffc84d62a89559fd86c389ce/%E5%8B%95%E7%94%BB.png\" alt=\"\"\u003e\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eコードブロックの挿入\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e公式APIでは対応していないコードブロックも、非公式APIを使っているNotion Blogでは表示できました。\u003cbr\u003e文字色のCSSなんかも自由にカスタマイズできます。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/20ed291c84c841a8a67807a6c96c2514/%E3%82%B3%E3%83%BC%E3%83%89%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003eただしNotion Blogで使っているのは非公式APIなので、\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e動作が不安定（実際、稀にコンテンツが取得できないという事が起こりました。）\u003c/li\u003e\u003cli\u003e今後このAPIが使えなくなる可能性もある\u003c/li\u003e\u003cli\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eというデメリットはあると思われます。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"hafa005fc12\"\u003e自分で実装した機能\u003c/h2\u003e\u003cp\u003e自分で追加実装した機能や、その他使用技術について書いていきます。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h604b8042b8\"\u003e検索機能\u003c/h3\u003e\u003cp\u003eカテゴリーで絞り込み・投稿月で絞りこみ・フリーキーワード検索の機能を実装しました。\u003cbr\u003e\u003cbr\u003eページ上部\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/5d8f8a862a3344fc8fe16447103ba0f6/%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8A%E9%83%A8.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003eフッター\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2cd3e007541943cb82954cf062c40479/%E3%83%95%E3%83%83%E3%82%BF%E3%83%BC.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e【実装手順】\u003cbr\u003e①　APIから取得したブログコンテンツに存在するカテゴリーを配列に格納して、記事が存在する分のカテゴリーボタンを表示。投稿月についても同様。\u003cbr\u003e②　ボタンを押したときや検索欄に入力をした際に発火する絞り込み処理を実装。\u003cbr\u003e\u003cbr\u003eフロント側で保持している記事データに対して絞り込みを行い表示を切り替える機能なので、リロードなく瞬時に表示が切り替わります。\u003cbr\u003e検索機能の書き方は非常に勉強になったので、別記事にまとめようと思います。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"hc06cf54a32\"\u003eReact Icons\u003c/h3\u003e\u003cp\u003e記事のカテゴリーに応じてアイコンを表示しました。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/6d8cb6b91d2740649bcd296b5d054bf6/react-icon.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003eアイコンといえばFontAwesomeと思っていましたが、React用のライブラリがありました。\u003cbr\u003e\u003ca href=\"https://react-icons.github.io/react-icons/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eReact Icons\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eこのライブラリをインストールすると、Font Awesome や Material、Typicons、Codicons（VSCode のアイコン）など色んな種類のアイコンを簡単に利用することができます。\u003cbr\u003e使い方は以下の記事を参考にさせて頂きました。\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/taichifukumoto/articles/how-to-use-react-icons\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eReact でアイコンを使うなら React Icons がおすすめ\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h5a4cb7eb5d\"\u003eCSS Modules\u003c/h3\u003e\u003cp\u003eCSSは、Notion BlogでCSS Modulesが使われていたので、そのままCSS Modulesを使いました。\u003cbr\u003e\u003cstrong\u003e\u003ccode\u003e.module.css\u003c/code\u003e\u003c/strong\u003e\u0026nbsp;で定義したクラス名がそのまま付与されるのではなく、実際はユニークなクラス名が自動的に生成されて付与されることも検証ツールで確認できて、勉強になりました。\u003cbr\u003e\u003cbr\u003eReactのプロジェクト下でのCSSといえば代表的な選択肢は、CSS Modules、styled-component、Tailwindあたりなのかと思いますが、それぞれの違いやメリットデメリットについては正直勉強不足です。。\u003cbr\u003e\u003ca href=\"https://kenzoblog.vercel.app/posts/css-manage\" target=\"_blank\" rel=\"noopener noreferrer\"\u003estyled-components, CSS Modules について調べたのでまとめる\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e業務ではTailwindを使っており、今回初めてCSS Modulesを使い、両者の個人的な感想を書いておきます。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eTailwind\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eファイルの行き来をせずスタイルを確認できて便利。小規模なプロダクトに向いていそう。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eCSS Modules\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eコンポーネント単位でスタイルをまとめるという思想なので、コンポーネント指向のReactとの相性は良い（のだと思う）。\u003cbr\u003eスタイルの共通化がしやすくスッキリ整理整頓されている感じで、使いやすかった。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"hf32963c38a\"\u003e全体の感想\u003c/h2\u003e\u003cp\u003e長くなってきたので細かい実装については書きませんが、「実装したい機能がある→どうやったら実現できるか調べる」というプロセスでReact・JavaScriptの書き方も色々勉強になりました。\u003cbr\u003e\u003cbr\u003e今回NotionをヘッドレスCMSとして使ってみて、フロントエンドを自前で作るという事は見た目を自由に作れるだけでなく、SG・SSRを使って機能性の高いサイトを作ることが出来ることが大きなメリットだと感じました。\u003cbr\u003e先輩に良いアドバイスもいただいたので、今度はまた他のヘッドレスCMSのサービスを使って個人ブログを作ってみたいなと思います。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"he45680f0bc\"\u003e参考記事\u003c/h2\u003e\u003cp\u003e\u003cbr\u003e\u003ca href=\"unsafe:[object Object]\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eHome | My Notion Blog\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/st43/articles/7982e6d371f8b8#notion-api%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E4%B8%80%E8%A6%A7\" target=\"_blank\" rel=\"noopener noreferrer\"\u003e現在のNotion API（2021/7/13）で何がどこまでできるか\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/st43/articles/9a714916c50b80#%E3%81%BE%E3%81%A8%E3%82%81\" target=\"_blank\" rel=\"noopener noreferrer\"\u003enotion-blogで無料の個人ブログをつくってみました\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e","tags":[{"id":"nextjs","createdAt":"2022-01-07T13:18:14.144Z","updatedAt":"2022-02-12T02:31:58.832Z","publishedAt":"2022-01-07T13:18:14.144Z","revisedAt":"2022-01-07T13:18:14.144Z","tag":"Next.js"},{"id":"react","createdAt":"2022-01-07T13:17:54.189Z","updatedAt":"2022-02-12T02:31:51.382Z","publishedAt":"2022-01-07T13:17:54.189Z","revisedAt":"2022-01-07T13:17:54.189Z","tag":"React"}],"image":"notion"},"highlightedBody":"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003ch2 id=\"h8d027c8ed3\"\u003eはじめに\u003c/h2\u003e\u003cp\u003e年末年始1週間の自由研究として、Next.jsを使って何か作ってみたい…ということで、NotionをヘッドレスCMSとした個人ブログを作ってみました。\u003cbr\u003e\u003cbr\u003eせっかくなので制作日記として、\u003c/p\u003e\u003cul\u003e\u003cli\u003e 作ったものを紹介\u003c/li\u003e\u003cli\u003e Notion Blogについて\u003c/li\u003e\u003cli\u003e Next.js（React）を使って自分で実装した機能\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eなどまとめておきたいと思います。\u003cbr\u003e\u003cbr\u003e※ヘッドレスCMSとは…従来型のCMS（WordPress等）は入稿画面・DB・表示画面をまとめて管理するのに対し、ここから表示画面を除いたもの。ヘッドレスCMSでは、API経由で取得したコンテンツを基にフロントエンド部分は自前で実装する必要がある。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"he961b4efa4\"\u003e制作物について\u003c/h2\u003e\u003cp\u003e実際に作ったものがこちらです。\u003cbr\u003e\u003ca href=\"https://hinako-blog.vercel.app/blog\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eHinako Blog | My Profile\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h0d376e5d4e\"\u003e構成\u003c/h3\u003e\u003cp\u003e構成を簡単に説明すると、\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eNotion上にブログ記事を保管するDBを作り、Notionで記事を執筆\u003c/li\u003e\u003cli\u003eNext.jsのgetStaticPropsでNotionのAPIを叩いてブログコンテンツを取得\u003c/li\u003e\u003cli\u003eNext.jsでレスポンスを成形してビューに表示\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003eという感じです。\u003cbr\u003e\u003cbr\u003eNotionのAPIを叩いてレスポンスを成形する部分は、Notion Blog（詳しくは後述）というOSSのテンプレートをベースに使わせていただきました。\u003cbr\u003eデプロイはVercelで行いました。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"had81f6e58c\"\u003e実装した機能\u003c/h3\u003e\u003cul\u003e\u003cli\u003eMITライセンスのOSSとして公開されているNotion Blog（Vercel社のJJ Kasperさん作）をベースに使用\u003c/li\u003e\u003cli\u003eDBにcategoryのカラムを追加し、NotionのAPIからのレスポンスの成形やビューへの表示をカスタマイズ\u003c/li\u003e\u003cli\u003eフロント側での「カテゴリーの選択」「投稿した月の選択」「フリーキーワードによる検索」によるリアルタイム検索機能\u003c/li\u003e\u003cli\u003e記事のカテゴリーに応じてReact iconsでアイコンを表示する\u003c/li\u003e\u003cli\u003eCSS Modules\u003c/li\u003e\u003cli\u003eUIパーツのコンポーネント化\u003c/li\u003e\u003cli\u003epropsやstateの値により、条件付きレンダリングを行ったりCSSを動的に切り替える\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"h5043d0744e\"\u003eNotion Blogについて\u003c/h2\u003e\u003cp\u003eベースに使用したNotion Blogというのは、NotionのAPIを叩いてNotionからコンテンツを取得しNext.jsでビューを作ったテンプレートです。\u003cbr\u003e\u003cbr\u003eGitHub：\u003ca style=\"color:#4aac00\" href=\"https://github.com/ijjk/notion-blog\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://github.com/ijjk/notion-blog\u003c/a\u003e\u003cbr\u003e公式のサンプルページ：\u003ca style=\"color:#4aac00\" href=\"https://notion-blog.vercel.app/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://notion-blog.vercel.app/\u003c/a\u003e\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/007ccf5040c24c7dad664d036d40997e/notion-blog.png\" alt=\"\"\u003e\u003cbr\u003eこんな感じでシンプルで綺麗なUIをしています。\u003cbr\u003eコードをいじったりしなくても、DeployボタンからVercelに連携し、NotionのDBのID・Tokenを環境変数に設定してVercelでデプロイするだけで、このテンプレート通りの個人ブログが出来るというものです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h0893011e20\"\u003eNotion Blogでブログコンテンツを取得する仕組み\u003c/h3\u003e\u003cp\u003eあらかじめNotionで記事を登録するDB（Page, Slug, Published, Date, Authorsの5つの要素を持つインラインテーブル）を作り、このテーブルに記事を入れておきます。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2df6468fd6054e47b8f1f212f7e5fa3a/table.png\" alt=\"\"\u003e\u003cbr\u003e画像引用：\u003ca style=\"color:#4aac00\" href=\"https://github.com/ijjk/notion-blog#manually-creating-the-table\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://github.com/ijjk/notion-blog#manually-creating-the-table\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eNotion Blogのソースを見ると、Next.jsのgetStaticPropsでNotionのAPIを叩いてデータベースのコンテンツを取得しています。\u003cbr\u003e使っているのは非公式のAPIで「\u003ca style=\"color:#4aac00\" href=\"https://www.notion.so/api/v3%E3%80%8D\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://www.notion.so/api/v3」\u003c/a\u003e\u0026nbsp;というエンドポイントを叩いているようです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h814caf386c\"\u003eNotion Blogを使った理由\u003c/h3\u003e\u003cp\u003eNotion 公式のAPI（ベータ版）も2021年5月に公開され、OSSとして公開されているテンプレートで公式APIが使われているものもある中で、Notion Blogを選んだ理由は以下の通りです。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e公式のNotion APIはコードブロックに対応していない（もしアップデートを見落としていたらすみません。）\u003c/li\u003e\u003cli\u003e公式のNotion APIでは、コンテンツを取得するだけでなくAPIを使ってNotionのDBへ追加・更新・削除する機能もあるが、これらの機能は不要と思った。\u003c/li\u003e\u003cli\u003eNotion Blogでは、決められた5つのカラムを持つテーブルをNotionで作るだけでテンプレート通りに表示される。簡単！はやい！\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003eざっくりいうと、\u003cstrong\u003eとりあえず最速・簡単な方法で小さく作って、残った時間でカスタマイズしてみよう\u003c/strong\u003eという感じです。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h2c8c89326b\"\u003eNotion Blogのセットアップ方法\u003c/h3\u003e\u003cp\u003eセットアップ方法は、公式サンプルのページに動画付きで分かりやすく書かれているので省略します。\u003cbr\u003e\u003cbr\u003e\u003ca style=\"color:#4aac00\" href=\"https://notion-blog.vercel.app/blog/my-first-post\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://notion-blog.vercel.app/blog/my-first-post\u003c/a\u003e\u003cbr\u003eDeployボタンからコードを目にすることも無くデプロイすることも出来るようですが、今回はAPIから受け取るレスポンスの成形やUIはカスタマイズする前提だったので、git cloneして編集したうえでデプロイしました。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h1d7f1fe064\"\u003eNotion Blogを使ってみて\u003c/h3\u003e\u003cul\u003e\u003cli\u003eテンプレートのコードを読んで\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eAPIへのリクエストを行うメソッドのファイル切り分け・ディレクトリ構成が分かりやすく、カスタマイズしやすかったです。\u003cbr\u003eNext.jsのダイナミックルーティングを使う際に、ヘッダのメタ情報を出しわける書き方も初めて見て勉強になりました。\u003cbr\u003e\u003cbr\u003eここからは、ブログ記事をブラウザで表示した時の見え方についてです。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e画像・動画の挿入\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e簡単に挿入できるものの、画像のアスペクト比が若干おかしくなっていました…。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/be464a17a7d74abe9afdcd84d268199b/%E7%94%BB%E5%83%8F%E5%8B%95%E7%94%BB.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e動画はNotionで見たまま反映され、再生速度の調整まで出来るのでこれはスゴイ！感激でした。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/f1847b01ffc84d62a89559fd86c389ce/%E5%8B%95%E7%94%BB.png\" alt=\"\"\u003e\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eコードブロックの挿入\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e公式APIでは対応していないコードブロックも、非公式APIを使っているNotion Blogでは表示できました。\u003cbr\u003e文字色のCSSなんかも自由にカスタマイズできます。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/20ed291c84c841a8a67807a6c96c2514/%E3%82%B3%E3%83%BC%E3%83%89%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003eただしNotion Blogで使っているのは非公式APIなので、\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e動作が不安定（実際、稀にコンテンツが取得できないという事が起こりました。）\u003c/li\u003e\u003cli\u003e今後このAPIが使えなくなる可能性もある\u003c/li\u003e\u003cli\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eというデメリットはあると思われます。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"hafa005fc12\"\u003e自分で実装した機能\u003c/h2\u003e\u003cp\u003e自分で追加実装した機能や、その他使用技術について書いていきます。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h604b8042b8\"\u003e検索機能\u003c/h3\u003e\u003cp\u003eカテゴリーで絞り込み・投稿月で絞りこみ・フリーキーワード検索の機能を実装しました。\u003cbr\u003e\u003cbr\u003eページ上部\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/5d8f8a862a3344fc8fe16447103ba0f6/%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8A%E9%83%A8.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003eフッター\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/2cd3e007541943cb82954cf062c40479/%E3%83%95%E3%83%83%E3%82%BF%E3%83%BC.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e【実装手順】\u003cbr\u003e①　APIから取得したブログコンテンツに存在するカテゴリーを配列に格納して、記事が存在する分のカテゴリーボタンを表示。投稿月についても同様。\u003cbr\u003e②　ボタンを押したときや検索欄に入力をした際に発火する絞り込み処理を実装。\u003cbr\u003e\u003cbr\u003eフロント側で保持している記事データに対して絞り込みを行い表示を切り替える機能なので、リロードなく瞬時に表示が切り替わります。\u003cbr\u003e検索機能の書き方は非常に勉強になったので、別記事にまとめようと思います。\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"hc06cf54a32\"\u003eReact Icons\u003c/h3\u003e\u003cp\u003e記事のカテゴリーに応じてアイコンを表示しました。\u003cbr\u003e\u003cimg src=\"https://images.microcms-assets.io/assets/bb9889e81cb24134954870eb1f2ba680/6d8cb6b91d2740649bcd296b5d054bf6/react-icon.png\" alt=\"\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003eアイコンといえばFontAwesomeと思っていましたが、React用のライブラリがありました。\u003cbr\u003e\u003ca href=\"https://react-icons.github.io/react-icons/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eReact Icons\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eこのライブラリをインストールすると、Font Awesome や Material、Typicons、Codicons（VSCode のアイコン）など色んな種類のアイコンを簡単に利用することができます。\u003cbr\u003e使い方は以下の記事を参考にさせて頂きました。\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/taichifukumoto/articles/how-to-use-react-icons\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eReact でアイコンを使うなら React Icons がおすすめ\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e\u003ch3 id=\"h5a4cb7eb5d\"\u003eCSS Modules\u003c/h3\u003e\u003cp\u003eCSSは、Notion BlogでCSS Modulesが使われていたので、そのままCSS Modulesを使いました。\u003cbr\u003e\u003cstrong\u003e\u003ccode\u003e.module.css\u003c/code\u003e\u003c/strong\u003e\u0026nbsp;で定義したクラス名がそのまま付与されるのではなく、実際はユニークなクラス名が自動的に生成されて付与されることも検証ツールで確認できて、勉強になりました。\u003cbr\u003e\u003cbr\u003eReactのプロジェクト下でのCSSといえば代表的な選択肢は、CSS Modules、styled-component、Tailwindあたりなのかと思いますが、それぞれの違いやメリットデメリットについては正直勉強不足です。。\u003cbr\u003e\u003ca href=\"https://kenzoblog.vercel.app/posts/css-manage\" target=\"_blank\" rel=\"noopener noreferrer\"\u003estyled-components, CSS Modules について調べたのでまとめる\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e業務ではTailwindを使っており、今回初めてCSS Modulesを使い、両者の個人的な感想を書いておきます。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eTailwind\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eファイルの行き来をせずスタイルを確認できて便利。小規模なプロダクトに向いていそう。\u003cbr\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eCSS Modules\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eコンポーネント単位でスタイルをまとめるという思想なので、コンポーネント指向のReactとの相性は良い（のだと思う）。\u003cbr\u003eスタイルの共通化がしやすくスッキリ整理整頓されている感じで、使いやすかった。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"hf32963c38a\"\u003e全体の感想\u003c/h2\u003e\u003cp\u003e長くなってきたので細かい実装については書きませんが、「実装したい機能がある→どうやったら実現できるか調べる」というプロセスでReact・JavaScriptの書き方も色々勉強になりました。\u003cbr\u003e\u003cbr\u003e今回NotionをヘッドレスCMSとして使ってみて、フロントエンドを自前で作るという事は見た目を自由に作れるだけでなく、SG・SSRを使って機能性の高いサイトを作ることが出来ることが大きなメリットだと感じました。\u003cbr\u003e先輩に良いアドバイスもいただいたので、今度はまた他のヘッドレスCMSのサービスを使って個人ブログを作ってみたいなと思います。\u003cbr\u003e\u003c/p\u003e\u003ch2 id=\"he45680f0bc\"\u003e参考記事\u003c/h2\u003e\u003cp\u003e\u003cbr\u003e\u003ca href=\"unsafe:[object Object]\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eHome | My Notion Blog\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/st43/articles/7982e6d371f8b8#notion-api%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E4%B8%80%E8%A6%A7\" target=\"_blank\" rel=\"noopener noreferrer\"\u003e現在のNotion API（2021/7/13）で何がどこまでできるか\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://zenn.dev/st43/articles/9a714916c50b80#%E3%81%BE%E3%81%A8%E3%82%81\" target=\"_blank\" rel=\"noopener noreferrer\"\u003enotion-blogで無料の個人ブログをつくってみました\u003c/a\u003e\u003cbr\u003e\u003c/p\u003e\u003c/body\u003e\u003c/html\u003e"},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"notion-blog"},"buildId":"EwuWiZmkeG3lYlO_XC9fM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>